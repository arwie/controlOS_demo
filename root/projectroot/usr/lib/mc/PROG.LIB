<?engage(['teach'])?>

<?com_websocket(55003)?>



<?com_prgReceive('this_websocket', 200)?>
	select case receive_
	case com_receiveMessage
		movePath()
	end select
	
	com_clear()
	com_putLocationXyzr("/here",		here)
	com_send(this_websocket)
end sub


<?lib_prgStop()?>
	delta1_disableDetach()
end sub


<?lib_prgError()?>
	stop stoptype=ABORT
	if not prgRunning then
		prog_prgStop()
		prog_stopTrigger()
	end if
end sub


sub movePath
	dim i as long
	
	try
		delta1_enableAttach()
		for i = 0 to com_size("/points")-1
			com_with("/points/"+str$(i))
			moves com_getLocationXyzr("path")
		next
		waitForMotion
	<?catchLog()?>
	delta1_disableDetach()
end sub
